<?php 
/*
 * IMPORTANTE
 * substituir todos os SLUG pelo slug do projeto
 */

include dirname(__FILE__).'/includes/congelado-functions.php';
include dirname(__FILE__).'/includes/html.class.php';
include dirname(__FILE__).'/includes/utils.class.php';
// include dirname(__FILE__).'/includes/form.class.php';


/////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////// CONTENT WIDTH   ///////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

if ( ! isset( $content_width ) ) $content_width = 980;

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////



add_action( 'after_setup_theme', 'SLUG_setup' );
function SLUG_setup() {

    load_theme_textdomain('SLUG', get_template_directory() . '/languages' );
    add_theme_support('automatic-feed-links');
    
    /////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////// POST THUMBNAILS   /////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////
    
    // POST THUMBNAILS
    add_theme_support('post-thumbnails');
    //set_post_thumbnail_size( 200, 150, true );

    //REGISTRAR AQUI TODOS OS TAMANHOS UTILIZADOS NO LAYOUT
    //add_image_size('nome',X,Y);
    //add_image_size('nome2',X,Y);

    /////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////

    
    
    
    
    
    /////////////////////////////////////////////////////////////////////////////////////////
    ///////////////////////////// CUSTOM BACKGROUND  ////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////
    
    add_theme_support('custom-background');
    
    /////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////

}


/////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////// CUSTOM HEADER  ////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

//include dirname(__FILE__).'/includes/custom-header.php';

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////






/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////// REMOVE ADMIN BAR FROM FRONT END  ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

remove_action('wp_footer','wp_admin_bar_render',1000);
function remove_admin_bar(){
   return false;
}
add_filter( 'show_admin_bar' , 'remove_admin_bar');

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////




/////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////// EXCERPT MORE  //////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

add_filter('utils_excerpt_more_link', 'SLUG_utils_excerpt_more',10,2);
function SLUG_utils_excerpt_more($more_link, $post){
    return '...<br /><a class="more-link" href="'. get_permalink($post->ID) . '">' . __('Continue reading &raquo;', 'SLUG') . '</a>';
}

add_filter( 'excerpt_more', 'SLUG_auto_excerpt_more' );
function SLUG_auto_excerpt_more( $more ) {
    global $post;
    return '...<br /><a class="more-link" href="'. get_permalink($post->ID) . '">' . __('Continue reading &raquo;', 'SLUG') . '</a>';
}

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////





/////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////// SIDEBARS  //////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

if(function_exists('register_sidebar')) {
    // sidebar 
    register_sidebar( array(
        'name' =>  'Sidebar',
        'description' => __('Sidebar', 'SLUG'),
        'before_widget' => '<div id="%1$s" class="widget %2$s"><div class="widget-content clearfix">',
        'after_widget' => '</div></div>',
        'before_title' => '<h3>',
        'after_title' => '</h3>',
    ) );
}

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////







/////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////   LOGIN SCREEN  //////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

function SLUG_custom_login_logo() {
	echo '
        <style type="text/css">
	        .login h1 a { background-image: url('. html::getImageUrl('logo.png') .'); background-size: auto; }
        </style>';
}
add_action('login_head', 'SLUG_custom_login_logo');

function new_headertitle($url){
    return get_bloginfo('sitetitle');
}
add_filter('login_headertitle','new_headertitle');

function custom_login_headerurl($url) {
    return home_url();

}
add_filter ('login_headerurl', 'custom_login_headerurl');

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////






/////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////// CUSTOM MENUS  //////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

add_action( 'init', 'SLUG_custom_menus' );
function SLUG_custom_menus() {
    register_nav_menus( array(
        'main' => __('Menu name', 'SLUG'),
    ) );
}

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////




/////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////// COMMENTS  //////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

if (!function_exists('SLUG_comment')):

    function SLUG_comment($comment, $args, $depth) {
        $GLOBALS['comment'] = $comment;
        ?>
        <li <?php comment_class("clearfix"); ?> id="comment-<?php comment_ID(); ?>">
            <p class="comment-meta alignright bottom">
                <?php comment_reply_link(array('depth' => $depth, 'max_depth' => $args['max_depth'])) ?> <?php edit_comment_link( __('Edit', 'SLUG'), '| ', ''); ?>          
            </p>    
            <p class="comment-meta bottom">
                <?php printf( __('By %s on %s at %s.', 'SLUG'), get_comment_author_link(), get_comment_date(), get_comment_time()); ?>
                <?php if($comment->comment_approved == '0') : ?><br/><em><?php _e('Your comment is awaiting moderation.', 'SLUG'); ?></em><?php endif; ?>
            </p>
            <?php echo get_avatar($comment, 66); ?>
            <div class="content">
                <?php comment_text(); ?>
            </div>
        </li>
        <?php
    }

endif; 

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////








/////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////// JAVSCRIPT & CSS  ///////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////

add_action('wp_print_scripts', 'SLUG_addJS');
function SLUG_addJS() {
    if ( is_singular() && get_option( 'thread_comments' ) ) wp_enqueue_script( 'comment-reply' ); 
    wp_enqueue_script('jquery');
    wp_enqueue_script('jquery-ui-core');
    wp_enqueue_script('jquery-ui-widget');
    
    wp_enqueue_script('congelado', get_stylesheet_directory_uri().'/js/congelado.js', array('jquery-ui-widget'));
    
    wp_localize_script('congelado', 'vars', array(
        'ajaxurl' => admin_url('admin-ajax.php')
    ));
    
}

add_action('wp_print_styles', 'SLUG_addCSS');
function SLUG_addCSS() {
    //wp_enqueue_style('XXXXX', get_stylesheet_directory_uri().'/css/XXXXX.css');
}

/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////


function ninja_video_details() {
	
	if (get_post_type() != 'video') return;
	
	$duracao = get_post_meta(get_the_ID(), 'duracao', true);
	$decupagem = get_post_meta(get_the_ID(), 'decupagem', true);
	?>
	Cidade: <?php the_terms(get_the_ID(), 'cidade'); ?><br/>
	Estado: <?php the_terms(get_the_ID(), 'estado'); ?><br/>
	Data da transmissão: <?php the_terms(get_the_ID(), 'data'); ?><br/>
	<b>Resumo:</b> <?php echo get_the_excerpt(); ?> <br/><br/>
	<?php if ($duracao): ?>
		<b>Duração:</b> <?php echo $duracao; ?> <br/>
	<?php endif; ?>
	<?php if ($decupagem): ?>
		<b>Decupagem:</b> <?php echo nl2br($decupagem); ?> <br/>
	<?php endif; ?>
	
	<?php
}
